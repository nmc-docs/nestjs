"use strict";(self.webpackChunkreactjs=self.webpackChunkreactjs||[]).push([[452],{7646:(n,e,c)=>{c.r(e),c.d(e,{assets:()=>o,contentTitle:()=>d,default:()=>a,frontMatter:()=>s,metadata:()=>l,toc:()=>h});var i=c(4848),t=c(8453);const s={sidebar_position:12},d="V\xf2ng \u0111\u1eddi c\u1ee7a events",l={id:"nestjs-fundamentals/lifecycle-events",title:"V\xf2ng \u0111\u1eddi c\u1ee7a events",description:"Lifecycle trong NestJS",source:"@site/docs/nestjs-fundamentals/lifecycle-events.md",sourceDirName:"nestjs-fundamentals",slug:"/nestjs-fundamentals/lifecycle-events",permalink:"/nestjs/nestjs-fundamentals/lifecycle-events",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:12,frontMatter:{sidebar_position:12},sidebar:"tutorialSidebar",previous:{title:"Custom decorator",permalink:"/nestjs/nestjs-fundamentals/custom-decorator"},next:{title:"Lu\u1ed3ng ho\u1ea1t \u0111\u1ed9ng",permalink:"/nestjs/nestjs-fundamentals/activity-stream"}},o={},h=[{value:"Lifecycle trong NestJS",id:"lifecycle-trong-nestjs",level:2},{value:"V\xed d\u1ee5",id:"v\xed-d\u1ee5",level:2},{value:"Ch\xfa \xfd nh\u1ecf",id:"ch\xfa-\xfd-nh\u1ecf",level:2}];function r(n){const e={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"v\xf2ng-\u0111\u1eddi-c\u1ee7a-events",children:"V\xf2ng \u0111\u1eddi c\u1ee7a events"})}),"\n",(0,i.jsx)(e.h2,{id:"lifecycle-trong-nestjs",children:"Lifecycle trong NestJS"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"NestJS c\u0169ng gi\u1ed1ng c\xe1c \u1ee9ng d\u1ee5ng kh\xe1c, \u0111\u1ec1u c\xf3 v\xf2ng \u0111\u1eddi. NestJS cung c\u1ea5p c\xe1c lifecycle hooks cho ch\xfang ta \u0111i\u1ec1u khi\u1ec3n c\xe1c event trong v\xf2ng \u0111\u1eddi."}),"\n",(0,i.jsx)(e.li,{children:"S\u01a1 \u0111\u1ed3 sau \u0111\xe2y m\xf4 t\u1ea3 c\xe1c chu\u1ed7i event quan tr\u1ecdng trong v\xf2ng \u0111\u1eddi c\u1ee7a \u1ee9ng d\u1ee5ng, t\u1eeb khi \u1ee9ng d\u1ee5ng \u0111\u01b0\u1ee3c kh\u1edfi \u0111\u1ed9ng cho \u0111\u1ebfn khi \u1ee9ng d\u1ee5ng \u0111\u01b0\u1ee3c ng\u1eaft."}),"\n",(0,i.jsx)(e.li,{children:"Ta c\xf3 th\u1ec3 chia v\xf2ng \u0111\u1eddi t\u1ed5ng th\u1ec3 th\xe0nh 3 giai \u0111o\u1ea1n: initializing (kh\u1edfi t\u1ea1o), running (ch\u1ea1y) v\xe0 terminating (k\u1ebft th\xfac). S\u1eed d\u1ee5ng v\xf2ng \u0111\u1eddi n\xe0y, ta c\xf3 th\u1ec3 th\u1ef1c hi\u1ec7n l\u1eadp k\u1ebf ho\u1ea1ch kh\u1edfi t\u1ea1o module v\xe0 c\xe1c service m\u1ed9t c\xe1ch ph\xf9 h\u1ee3p, qu\u1ea3n l\xfd c\xe1c k\u1ebft n\u1ed1i \u0111ang ho\u1ea1t \u0111\u1ed9ng v\xe0 ng\u1eaft \u1ee9ng d\u1ee5ng m\u1ed9t c\xe1ch ph\xf9 h\u1ee3p."}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"1718291885188",src:c(2517).A+"",width:"970",height:"820"})}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"Lifecycle hook"}),(0,i.jsx)(e.th,{children:"M\xf4 t\u1ea3"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"onModuleInit()"})}),(0,i.jsx)(e.td,{children:"\u0110\u01b0\u1ee3c g\u1ecdi\xa0M\u1ed8T L\u1ea6N\xa0sau khi m\u1ed9t module \u0111\u01b0\u1ee3c kh\u1edfi t\u1ea1o."})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"onApplicationBootstrap()"})}),(0,i.jsxs)(e.td,{children:["\u0110\u01b0\u1ee3c g\u1ecdi M\u1ed8T L\u1ea6N sau khi t\u1ea5t c\u1ea3 c\xe1c module \u0111\u01b0\u1ee3c kh\u1edfi t\u1ea1o xong v\xe0 tr\u01b0\u1edbc khi l\u1eafng nghe k\u1ebft n\u1ed1i (",(0,i.jsx)(e.strong,{children:"app.listen()"}),").\xa0Th\u01b0\u1eddng \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 th\u1ef1c hi\u1ec7n c\xe1c t\xe1c v\u1ee5 sau khi \u1ee9ng d\u1ee5ng \u0111\xe3 s\u1eb5n s\xe0ng, nh\u01b0 \u0111\u0103ng k\xfd c\xe1c l\u1ecbch tr\xecnh, kh\u1edfi t\u1ea1o cache, v.v."]})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"onModuleDestroy()"})}),(0,i.jsx)(e.td,{children:"\u0110\u01b0\u1ee3c g\u1ecdi khi m\u1ed9t module s\u1eafp b\u1ecb h\u1ee7y. Th\u01b0\u1eddng \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 th\u1ef1c hi\u1ec7n c\xe1c t\xe1c v\u1ee5 d\u1ecdn d\u1eb9p, nh\u01b0 gi\u1ea3i ph\xf3ng t\xe0i nguy\xean, h\u1ee7y \u0111\u0103ng k\xfd c\xe1c d\u1ecbch v\u1ee5, v.v."})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"beforeApplicationShutdown()"})}),(0,i.jsxs)(e.td,{children:["\u0110\u01b0\u1ee3c g\u1ecdi sau khi",(0,i.jsx)(e.strong,{children:"onModuleDestroy()"})," th\u1ef1c thi xong (b\u1ea5t k\u1ec3 l\xe0 resolved hay rejected). Sau \u0111\xf3, t\u1ea5t c\u1ea3 c\xe1c k\u1ebft n\u1ed1i s\u1ebd \u0111\u01b0\u1ee3c \u0111\xf3ng l\u1ea1i (",(0,i.jsx)(e.strong,{children:"app.close()"})," \u0111\u01b0\u1ee3c g\u1ecdi)"]})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"onApplicationShutdown()"})}),(0,i.jsxs)(e.td,{children:["\u0110\u01b0\u1ee3c g\u1ecdi sau khi t\u1ea5t c\u1ea3 k\u1ebft n\u1ed1i \u0111\u01b0\u1ee3c \u0111\xf3ng (",(0,i.jsx)(e.strong,{children:"app.close()"})," \u0111\u01b0\u1ee3c resolved)"]})]})]})]}),"\n",(0,i.jsx)(e.h2,{id:"v\xed-d\u1ee5",children:"V\xed d\u1ee5"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Sau \u0111\xe2y l\xe0 m\u1ed9t v\xed d\u1ee5 v\u1edbi ",(0,i.jsx)(e.strong,{children:"onModuleInit()"}),":"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-ts",metastring:'title="users.service.ts"',children:'import { Injectable, OnModuleInit } from "@nestjs/common";\n\n@Injectable()\nexport class UsersService implements OnModuleInit {\n  onModuleInit() {\n    console.log(`The module has been initialized.`);\n  }\n}\n'})}),"\n",(0,i.jsx)(e.h2,{id:"ch\xfa-\xfd-nh\u1ecf",children:"Ch\xfa \xfd nh\u1ecf"}),"\n",(0,i.jsx)(e.admonition,{type:"note",children:(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Ta c\xf3 v\xed d\u1ee5 sau:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"PrismaService"})," c\xf3 ",(0,i.jsx)(e.code,{children:"onModuleInit()"})," \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a trong ",(0,i.jsx)(e.code,{children:"PrismaModule"}),"."]}),"\n",(0,i.jsxs)(e.li,{children:["Ta import ",(0,i.jsx)(e.code,{children:"PrismaModule"})," v\xe0o ",(0,i.jsx)(e.code,{children:"AuthModule"}),"."]}),"\n",(0,i.jsxs)(e.li,{children:["Ta import ",(0,i.jsx)(e.code,{children:"AuthModule"})," v\xe0o ",(0,i.jsx)(e.code,{children:"AppModule"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Khi \u1ee9ng d\u1ee5ng NestJS kh\u1edfi \u0111\u1ed9ng:"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"AppModule"})," \u0111\u01b0\u1ee3c kh\u1edfi t\u1ea1o, v\xe0 n\xf3 s\u1ebd kh\u1edfi t\u1ea1o t\u1ea5t c\u1ea3 c\xe1c module m\xe0 n\xf3 import, bao g\u1ed3m ",(0,i.jsx)(e.code,{children:"AuthModule"}),"."]}),"\n",(0,i.jsxs)(e.li,{children:["V\xec ",(0,i.jsx)(e.code,{children:"AuthModule"})," import ",(0,i.jsx)(e.code,{children:"PrismaModule"}),", n\xean ",(0,i.jsx)(e.code,{children:"PrismaService"})," s\u1ebd \u0111\u01b0\u1ee3c kh\u1edfi t\u1ea1o."]}),"\n",(0,i.jsxs)(e.li,{children:["Sau khi ",(0,i.jsx)(e.code,{children:"PrismaService"})," \u0111\u01b0\u1ee3c kh\u1edfi t\u1ea1o, h\xe0m ",(0,i.jsx)(e.code,{children:"onModuleInit"})," c\u1ee7a n\xf3 s\u1ebd \u0111\u01b0\u1ee3c g\u1ecdi."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Nh\u01b0 v\u1eady, h\xe0m ",(0,i.jsx)(e.code,{children:"onModuleInit"})," trong ",(0,i.jsx)(e.code,{children:"PrismaService"})," s\u1ebd \u0111\u01b0\u1ee3c ch\u1ea1y, d\xf9 ta kh\xf4ng tr\u1ef1c ti\u1ebfp import ",(0,i.jsx)(e.code,{children:"PrismaModule"})," v\xe0o ",(0,i.jsx)(e.code,{children:"AppModule"}),", m\xe0 ch\u1ec9 th\xf4ng qua vi\u1ec7c import gi\xe1n ti\u1ebfp qua ",(0,i.jsx)(e.code,{children:"AuthModule"}),". N\xf3 c\u0169ng ho\u1ea1t \u0111\u1ed9ng t\u01b0\u01a1ng t\u1ef1 nh\u01b0 v\u1eady khi ta import gi\xe1n ti\u1ebfp qua nhi\u1ec1u c\u1ea5p \u0111\u1ed9."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Tr\u01b0\u1eddng h\u1ee3p ",(0,i.jsx)(e.code,{children:"PrismaModule"})," kh\xf4ng \u0111\u01b0\u1ee3c import v\xe0o b\u1ea5t c\u1ee9 module n\xe0o ngo\xe0i ",(0,i.jsx)(e.code,{children:"AppModule"})," m\xe0 ta mu\u1ed1n ch\u1ea1y h\xe0m ",(0,i.jsx)(e.code,{children:"onModuleInit()"})," th\xec l\xfac n\xe0y ta ph\u1ea3i import tr\u1ef1c ti\u1ebfp ",(0,i.jsx)(e.code,{children:"PrismaModule"})," v\xe0o ",(0,i.jsx)(e.code,{children:"AppModule"}),"."]}),"\n"]}),"\n"]})})]})}function a(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(r,{...n})}):r(n)}},2517:(n,e,c)=>{c.d(e,{A:()=>i});const i=c.p+"assets/images/1718291885188-ac48ba7c0fda5ddc032c201fdb58ad43.png"},8453:(n,e,c)=>{c.d(e,{R:()=>d,x:()=>l});var i=c(6540);const t={},s=i.createContext(t);function d(n){const e=i.useContext(s);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:d(n.components),i.createElement(s.Provider,{value:e},n.children)}}}]);