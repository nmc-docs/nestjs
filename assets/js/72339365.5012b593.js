"use strict";(self.webpackChunkreactjs=self.webpackChunkreactjs||[]).push([[13],{2603:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>t,metadata:()=>d,toc:()=>o});var s=r(4848),c=r(8453);const t={sidebar_position:10},i="Circular dependency",d={id:"nestjs-fundamentals/circular-dependency",title:"Circular dependency",description:"Circular dependency l\xe0 g\xec?",source:"@site/docs/nestjs-fundamentals/circular-dependency.md",sourceDirName:"nestjs-fundamentals",slug:"/nestjs-fundamentals/circular-dependency",permalink:"/nestjs/nestjs-fundamentals/circular-dependency",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:10,frontMatter:{sidebar_position:10},sidebar:"tutorialSidebar",previous:{title:"Interceptors",permalink:"/nestjs/nestjs-fundamentals/interceptors"},next:{title:"Custom decorator",permalink:"/nestjs/nestjs-fundamentals/custom-decorator"}},l={},o=[{value:"Circular dependency l\xe0 g\xec?",id:"circular-dependency-l\xe0-g\xec",level:2},{value:"V\xed d\u1ee5 v\u1ec1 Circular Dependency trong NestJS",id:"v\xed-d\u1ee5-v\u1ec1-circular-dependency-trong-nestjs",level:2},{value:"C\xe1ch kh\u1eafc ph\u1ee5c Circular Dependency trong NestJS",id:"c\xe1ch-kh\u1eafc-ph\u1ee5c-circular-dependency-trong-nestjs",level:2}];function a(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"circular-dependency",children:"Circular dependency"})}),"\n",(0,s.jsx)(n.h2,{id:"circular-dependency-l\xe0-g\xec",children:"Circular dependency l\xe0 g\xec?"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Circular dependency (ph\u1ee5 thu\u1ed9c v\xf2ng tr\xf2n) trong NestJS x\u1ea3y ra khi hai ho\u1eb7c nhi\u1ec1u module/service ph\u1ee5 thu\u1ed9c v\xe0o nhau theo v\xf2ng l\u1eb7p, d\u1eabn \u0111\u1ebfn l\u1ed7i ho\u1eb7c h\xe0nh vi kh\xf4ng mong mu\u1ed1n trong \u1ee9ng d\u1ee5ng."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"V\xed d\u1ee5 \u0111\u01a1n gi\u1ea3n v\u1ec1 circular dependency:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ServiceA"})," ph\u1ee5 thu\u1ed9c v\xe0o ",(0,s.jsx)(n.code,{children:"ServiceB"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ServiceB"})," l\u1ea1i ph\u1ee5 thu\u1ed9c ng\u01b0\u1ee3c l\u1ea1i v\xe0o ",(0,s.jsx)(n.code,{children:"ServiceA"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"\u0110i\u1ec1u n\xe0y t\u1ea1o ra m\u1ed9t v\xf2ng l\u1eb7p v\xe0 NestJS s\u1ebd kh\xf4ng th\u1ec3 kh\u1edfi t\u1ea1o c\xe1c service m\u1ed9t c\xe1ch \u0111\xfang \u0111\u1eafn."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"v\xed-d\u1ee5-v\u1ec1-circular-dependency-trong-nestjs",children:"V\xed d\u1ee5 v\u1ec1 Circular Dependency trong NestJS"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Gi\u1ea3 s\u1eed ta c\xf3 hai service: ",(0,s.jsx)(n.code,{children:"UsersService"})," v\xe0 ",(0,s.jsx)(n.code,{children:"AuthService"}),":"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { Injectable } from "@nestjs/common";\nimport { AuthService } from "../auth/auth.service";\n\n@Injectable()\nexport class UsersService {\n  constructor(private readonly authService: AuthService) {}\n\n  getUser() {\n    return "User data";\n  }\n\n  validateUser() {\n    return this.authService.validateUser();\n  }\n}\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { Injectable } from "@nestjs/common";\nimport { UsersService } from "../users/users.service";\n\n@Injectable()\nexport class AuthService {\n  constructor(private readonly usersService: UsersService) {}\n\n  validateUser() {\n    return this.usersService.getUser();\n  }\n}\n'})}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"C\u1ea3 hai service \u0111\u1ec1u ph\u1ee5 thu\u1ed9c v\xe0o nhau, d\u1eabn \u0111\u1ebfn circular dependency."}),"\n"]})}),"\n",(0,s.jsx)(n.h2,{id:"c\xe1ch-kh\u1eafc-ph\u1ee5c-circular-dependency-trong-nestjs",children:"C\xe1ch kh\u1eafc ph\u1ee5c Circular Dependency trong NestJS"}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Ta s\u1ebd s\u1eed d\u1ee5ng ",(0,s.jsx)(n.code,{children:"forwardRef()"})," \u0111\u1ec3 gi\u1ea3i quy\u1ebft Circular Dependency."]}),"\n"]})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["C\u1eadp nh\u1eadt ",(0,s.jsx)(n.code,{children:"UserService"}),":"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { Injectable, forwardRef, Inject } from "@nestjs/common";\nimport { AuthService } from "../auth/auth.service";\n\n@Injectable()\nexport class UsersService {\n  constructor(\n    @Inject(forwardRef(() => AuthService))\n    private readonly authService: AuthService\n  ) {}\n\n  getUser() {\n    return "User data";\n  }\n\n  validateUser() {\n    return this.authService.validateUser();\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["C\u1eadp nh\u1eadt ",(0,s.jsx)(n.code,{children:"AuthService"}),":"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { Injectable, forwardRef, Inject } from "@nestjs/common";\nimport { UsersService } from "../users/users.service";\n\n@Injectable()\nexport class AuthService {\n  constructor(\n    @Inject(forwardRef(() => UsersService))\n    private readonly usersService: UsersService\n  ) {}\n\n  validateUser() {\n    return this.usersService.getUser();\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Sau \u0111\xf3, trong ",(0,s.jsx)(n.code,{children:"AuthModule"})," v\xe0 ",(0,s.jsx)(n.code,{children:"UsersModule"}),", s\u1eed d\u1ee5ng ",(0,s.jsx)(n.code,{children:"forwardRef"})," khi import:"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { Module, forwardRef } from "@nestjs/common";\nimport { UsersService } from "./users.service";\nimport { AuthModule } from "../auth/auth.module";\n\n@Module({\n  providers: [UsersService],\n  exports: [UsersService],\n  imports: [forwardRef(() => AuthModule)],\n})\nexport class UsersModule {}\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { Module, forwardRef } from "@nestjs/common";\nimport { AuthService } from "./auth.service";\nimport { UsersModule } from "../users/users.module";\n\n@Module({\n  providers: [AuthService],\n  exports: [AuthService],\n  imports: [forwardRef(() => UsersModule)],\n})\nexport class AuthModule {}\n'})})]})}function u(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>d});var s=r(6540);const c={},t=s.createContext(c);function i(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:i(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);