"use strict";(self.webpackChunkreactjs=self.webpackChunkreactjs||[]).push([[166],{7375:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>d,contentTitle:()=>c,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>i});var n=t(4848),s=t(8453);const o={sidebar_position:3},c="Controllers",l={id:"nestjs-fundamentals/controllers",title:"Controllers",description:"Controller l\xe0 g\xec?",source:"@site/docs/nestjs-fundamentals/controllers.md",sourceDirName:"nestjs-fundamentals",slug:"/nestjs-fundamentals/controllers",permalink:"/nestjs/nestjs-fundamentals/controllers",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Modules",permalink:"/nestjs/nestjs-fundamentals/modules"},next:{title:"Pipes",permalink:"/nestjs/nestjs-fundamentals/pipes"}},d={},i=[{value:"Controller l\xe0 g\xec?",id:"controller-l\xe0-g\xec",level:2},{value:"L\u1ec7nh CLI \u0111\u1ec3 t\u1ea1o file controller",id:"l\u1ec7nh-cli-\u0111\u1ec3-t\u1ea1o-file-controller",level:2},{value:"Request Method",id:"request-method",level:2},{value:"Request Object",id:"request-object",level:2},{value:"Status code",id:"status-code",level:2},{value:"Header Response",id:"header-response",level:2}];function h(e){const r={admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",ol:"ol",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.h1,{id:"controllers",children:"Controllers"}),"\n",(0,n.jsx)(r.h2,{id:"controller-l\xe0-g\xec",children:"Controller l\xe0 g\xec?"}),"\n",(0,n.jsxs)(r.admonition,{type:"info",children:[(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Trong NestJS, m\u1ed9t controller l\xe0 m\u1ed9t l\u1edbp \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 \u0111\u1ecbnh ngh\u0129a c\xe1c endpoint (\u0111i\u1ec3m cu\u1ed1i) c\u1ee7a \u1ee9ng d\u1ee5ng v\xe0 x\u1eed l\xfd c\xe1c y\xeau c\u1ea7u HTTP \u0111\u1ebfn c\xe1c endpoint n\xe0y."}),"\n",(0,n.jsx)(r.li,{children:"M\u1ed9t controller trong NestJS th\u01b0\u1eddng c\xf3 c\xe1c \u0111\u1eb7c \u0111i\u1ec3m sau:"}),"\n"]}),(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"\u0110\u1ecbnh ngh\u0129a c\xe1c endpoint"})," : Controller s\u1ebd \u0111\u1ecbnh ngh\u0129a c\xe1c endpoint m\xe0 \u1ee9ng d\u1ee5ng s\u1ebd \u0111\xe1p \u1ee9ng, ch\u1eb3ng h\u1ea1n nh\u01b0 ",(0,n.jsx)(r.code,{children:"/users"}),", ",(0,n.jsx)(r.code,{children:"/products"}),", v.v."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"X\u1eed l\xfd c\xe1c y\xeau c\u1ea7u HTTP"})," : Controller s\u1ebd x\u1eed l\xfd c\xe1c y\xeau c\u1ea7u HTTP (GET, POST, PUT, DELETE, v.v.) \u0111\u01b0\u1ee3c g\u1eedi \u0111\u1ebfn c\xe1c endpoint \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"T\u01b0\u01a1ng t\xe1c v\u1edbi c\xe1c d\u1ecbch v\u1ee5"})," : Controller s\u1ebd t\u01b0\u01a1ng t\xe1c v\u1edbi c\xe1c d\u1ecbch v\u1ee5 (service) \u0111\u1ec3 th\u1ef1c hi\u1ec7n c\xe1c t\xe1c v\u1ee5 c\u1ea7n thi\u1ebft."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Tr\u1ea3 v\u1ec1 ph\u1ea3n h\u1ed3i"})," : Controller s\u1ebd tr\u1ea3 v\u1ec1 ph\u1ea3n h\u1ed3i HTTP th\xedch h\u1ee3p (nh\u01b0 m\xe3 tr\u1ea1ng th\xe1i, d\u1eef li\u1ec7u JSON, v.v.) cho client."]}),"\n"]}),(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["\u0110\u1ec3 \u0111\u1ecbnh ngh\u0129a m\u1ed9t controller trong NestJS, ta s\u1eed d\u1ee5ng decorator ",(0,n.jsx)(r.code,{children:"@Controller()"})," v\xe0 \u0111\u1eb7t c\xe1c ph\u01b0\u01a1ng th\u1ee9c x\u1eed l\xfd c\xe1c y\xeau c\u1ea7u HTTP nh\u01b0 ",(0,n.jsx)(r.code,{children:"@Get()"}),", ",(0,n.jsx)(r.code,{children:"@Post()"}),", ",(0,n.jsx)(r.code,{children:"@Put()"}),", ",(0,n.jsx)(r.code,{children:"@Delete()"}),", v.v."]}),"\n"]})]}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"V\xed d\u1ee5 v\u1ec1 1 file controller:"}),"\n"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-ts",children:'import { Body, Controller, Get, Post } from "@nestjs/common";\n\nimport { CustomersService } from "src/modules/customers/customers.service";\nimport CreateCustomerDto from "src/modules/customers/dto/create-customer.dto";\n\n@Controller("customers")\nexport class CustomersController {\n  constructor(private customerService: CustomersService) {}\n\n  @Post("/create")\n  createCustomer(@Body() body: CreateCustomerDto) {\n    const createdCustomer = this.customerService.create(body);\n    return createdCustomer;\n  }\n\n  @Get("/list")\n  getCustomers() {\n    return this.customerService.getCustomers();\n  }\n}\n'})}),"\n",(0,n.jsx)(r.admonition,{type:"note",children:(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["Trong v\xed d\u1ee5 tr\xean, ta t\u1ea1o 2 endpoint:","\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"/customers/create"}),": t\u1ea1o m\u1edbi 1 customer v\u1edbi method ",(0,n.jsx)(r.strong,{children:"POST"})]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"/customers/list"}),": l\u1ea5y danh s\xe1ch c\xe1c customers v\u1edbi method ",(0,n.jsx)(r.strong,{children:"GET"})]}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Sau khi t\u1ea1o xong controller, ta import n\xf3 v\xe0o module:"}),"\n"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-ts",children:"@Module({\n  controllers: [CustomersController],\n  providers: [CustomersService],\n})\nexport class CustomersModule {}\n"})}),"\n",(0,n.jsx)(r.h2,{id:"l\u1ec7nh-cli-\u0111\u1ec3-t\u1ea1o-file-controller",children:"L\u1ec7nh CLI \u0111\u1ec3 t\u1ea1o file controller"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"nest g controller [MODULE_NAME]\n"})}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:'V\xed d\u1ee5 c\xe2u l\u1ec7nh sau s\u1ebd t\u1ea1o file "customer.controller.ts" b\xean trong th\u01b0 m\u1ee5c "src/modules/customer":'}),"\n"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"nest g controller modules/customer\n"})}),"\n",(0,n.jsx)(r.h2,{id:"request-method",children:"Request Method"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"D\u01b0\u1edbi \u0111\xe2y l\xe0 c\xe1c decorator bi\u1ec3u th\u1ecb c\xe1c ph\u01b0\u01a1ng th\u1ee9c HTTP:"}),"\n"]}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Decorator"}),(0,n.jsx)(r.th,{children:"M\xf4 t\u1ea3"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"@Get()"}),(0,n.jsx)(r.td,{children:"Ph\u01b0\u01a1ng th\u1ee9c GET"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"@Post()"}),(0,n.jsx)(r.td,{children:"Ph\u01b0\u01a1ng th\u1ee9c POST"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"@Put()"}),(0,n.jsx)(r.td,{children:"Ph\u01b0\u01a1ng th\u1ee9c PUT"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"@Delete()"}),(0,n.jsx)(r.td,{children:"Ph\u01b0\u01a1ng th\u1ee9c DELETE"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"@All()"}),(0,n.jsx)(r.td,{children:"X\u1eed l\xfd t\u1ea5t c\u1ea3 c\xe1c ph\u01b0\u01a1ng th\u1ee9c tr\xean"})]})]})]}),"\n",(0,n.jsx)(r.h2,{id:"request-object",children:"Request Object"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Trong m\u1ed7i h\xe0m controller, ta \u0111\u1ec1u c\xf3 th\u1ec3 truy xu\u1ea5t c\xe1c th\xf4ng tin c\u1ee7a request nh\u01b0 body, params, query, header,... th\xf4ng qua c\xe1c decorator m\xe0 NestJS cung c\u1ea5p s\u1eb5n nh\u01b0 \u1edf d\u01b0\u1edbi \u0111\xe2y:"}),"\n"]}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Decorator"}),(0,n.jsx)(r.th,{children:"M\xf4 t\u1ea3"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"@Request(), @Req()"}),(0,n.jsx)(r.td,{children:"req"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"@Response(), @Res()"}),(0,n.jsx)(r.td,{children:"res"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"@Next()"}),(0,n.jsx)(r.td,{children:"next"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"@Session()"}),(0,n.jsx)(r.td,{children:"req.session"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"@Param(key?: string)"}),(0,n.jsx)(r.td,{children:"req.params / req.params[key]"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"@Body(key?: string)"}),(0,n.jsx)(r.td,{children:"req.body / req.body[key]"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"@Query(key?: string)"}),(0,n.jsx)(r.td,{children:"req.query / req.query[key]"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"@Headers(name?: string)"}),(0,n.jsx)(r.td,{children:"req.headers / req.headers[name]"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"@Ip()"}),(0,n.jsx)(r.td,{children:"req.ip"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"@HostParam()"}),(0,n.jsx)(r.td,{children:"req.hosts"})]})]})]}),"\n",(0,n.jsx)(r.admonition,{type:"note",children:(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Ta c\xf3 th\u1ec3 l\u1ea5y t\u1ea5t c\u1ea3 c\xe1c thu\u1ed9c t\xednh c\u1ee7a body, params ho\u1eb7c query v\u1edbi c\xe1ch vi\u1ebft nh\u01b0 @Body() body: CreateCustomerDTO. Sau \u0111\xf3 truy xu\u1ea5t c\xe1c thu\u1ed9c t\xednh th\xf4ng qua body.fullName, body.email,..."}),"\n",(0,n.jsx)(r.li,{children:'N\u1ebfu body, query ho\u1eb7c params truy\u1ec1n v\xe0o m\xe0 c\xf3 1 thu\u1ed9c t\xednh th\xec ta c\xf3 th\u1ec3 l\u1ea5y qua key c\u1ee7a n\xf3 thay v\xec ph\u1ea3i \u0111\u1ecbnh ngh\u0129a type cho object. V\xed d\u1ee5 nh\u01b0 @Param("id") userId: string.'}),"\n"]})}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"V\xed d\u1ee5:"}),"\n"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-ts",children:'import { Body, Controller, Get, Headers, Param, Post } from "@nestjs/common";\n\nimport { CustomersService } from "src/modules/customers/customers.service";\nimport CreateCustomerDto from "src/modules/customers/dto/create-customer.dto";\n\n@Controller("customers")\nexport class CustomersController {\n  constructor(private customerService: CustomersService) {}\n\n  @Post("/create")\n  createCustomer(\n    @Body() body: CreateCustomerDto,\n    @Headers("authorization") auth: string\n  ) {\n    const createdCustomer = this.customerService.create(body);\n    console.log("Auth:", auth); // In ra gi\xe1 tr\u1ecb c\u1ee7a "authorization" \u1edf header\n    return createdCustomer;\n  }\n\n  @Get("/:id")\n  getCustomerById(@Param("id") userId: string) {\n    return this.customerService.getCustomerById(userId);\n  }\n}\n'})}),"\n",(0,n.jsx)(r.h2,{id:"status-code",children:"Status code"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["Ta c\xf3 th\u1ec3 custom HTTP Response Status Code th\xf4ng qua decorator ",(0,n.jsx)(r.strong,{children:"@HttpCode()"})]}),"\n",(0,n.jsx)(r.li,{children:"V\xed d\u1ee5:"}),"\n"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-ts",children:'import {\n  Body,\n  Controller,\n  Get,\n  HttpCode,\n  HttpStatus,\n  Post,\n} from "@nestjs/common";\n\nimport { CustomersService } from "src/modules/customers/customers.service";\nimport CreateCustomerDto from "src/modules/customers/dto/create-customer.dto";\n\n@Controller("customers")\nexport class CustomersController {\n  constructor(private customerService: CustomersService) {}\n\n  @Post("/create")\n  @HttpCode(HttpStatus.NOT_FOUND)\n  createCustomer(@Body() body: CreateCustomerDto) {\n    const createdCustomer = this.customerService.create(body);\n    return createdCustomer;\n  }\n}\n'})}),"\n",(0,n.jsx)(r.h2,{id:"header-response",children:"Header Response"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["Ta c\xf3 th\u1ec3 th\xeam c\xe1c key - value trong response tr\u1ea3 v\u1ec1 c\u1ee7a header th\xf4ng qua decorator ",(0,n.jsx)(r.strong,{children:"@Header()"})]}),"\n",(0,n.jsx)(r.li,{children:"V\xed d\u1ee5:"}),"\n"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-ts",children:'import { Body, Controller, Get, Header, Param, Post } from "@nestjs/common";\n\nimport { CustomersService } from "src/modules/customers/customers.service";\nimport CreateCustomerDto from "src/modules/customers/dto/create-customer.dto";\n\n@Controller("customers")\nexport class CustomersController {\n  constructor(private customerService: CustomersService) {}\n\n  @Header("Message", "Customer created successfully")\n  @Header("Status", "Thanh cong")\n  @Post("/create")\n  createCustomer(@Body() body: CreateCustomerDto) {\n    const createdCustomer = this.customerService.create(body);\n    return createdCustomer;\n  }\n}\n'})})]})}function u(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},8453:(e,r,t)=>{t.d(r,{R:()=>c,x:()=>l});var n=t(6540);const s={},o=n.createContext(s);function c(e){const r=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),n.createElement(o.Provider,{value:r},e.children)}}}]);