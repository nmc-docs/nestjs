"use strict";(self.webpackChunkreactjs=self.webpackChunkreactjs||[]).push([[486],{1909:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>a,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>c,toc:()=>l});var t=s(4848),r=s(8453);const o={sidebar_position:8},i="Nestjs Swagger",c={id:"nestjs-swagger",title:"Nestjs Swagger",description:"C\xe0i \u0111\u1eb7t th\u01b0 vi\u1ec7n",source:"@site/docs/nestjs-swagger.md",sourceDirName:".",slug:"/nestjs-swagger",permalink:"/nestjs/nestjs-swagger",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8},sidebar:"tutorialSidebar",previous:{title:"Serve static file trong NestJS",permalink:"/nestjs/serve-static-file"},next:{title:"Note v\u1ec1 NestJS",permalink:"/nestjs/nestjs-note"}},a={},l=[{value:"C\xe0i \u0111\u1eb7t th\u01b0 vi\u1ec7n",id:"c\xe0i-\u0111\u1eb7t-th\u01b0-vi\u1ec7n",level:2},{value:"C\u1ea5u h\xecnh Swagger Plugin",id:"c\u1ea5u-h\xecnh-swagger-plugin",level:2},{value:"C\u1ea5u h\xecnh Swagger",id:"c\u1ea5u-h\xecnh-swagger",level:2},{value:"S\u1eed d\u1ee5ng NestJS Swagger decorator b\xean trong controller",id:"s\u1eed-d\u1ee5ng-nestjs-swagger-decorator-b\xean-trong-controller",level:2},{value:"S\u1eed d\u1ee5ng NestJS Swagger decorator \u0111\u1ec3 \u0111\u1ecbnh ngh\u0129a DTO",id:"s\u1eed-d\u1ee5ng-nestjs-swagger-decorator-\u0111\u1ec3-\u0111\u1ecbnh-ngh\u0129a-dto",level:2}];function h(n){const e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"nestjs-swagger",children:"Nestjs Swagger"})}),"\n",(0,t.jsx)(e.h2,{id:"c\xe0i-\u0111\u1eb7t-th\u01b0-vi\u1ec7n",children:"C\xe0i \u0111\u1eb7t th\u01b0 vi\u1ec7n"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"npm install @nestjs/swagger\n"})}),"\n",(0,t.jsx)(e.h2,{id:"c\u1ea5u-h\xecnh-swagger-plugin",children:"C\u1ea5u h\xecnh Swagger Plugin"}),"\n",(0,t.jsxs)(e.admonition,{type:"info",children:[(0,t.jsx)(e.p,{children:"Plugin Swagger s\u1ebd t\u1ef1 \u0111\u1ed9ng:"}),(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"T\u1ef1 \u0111\u1ed9ng \u0111\u1ecdc c\xe1c thu\u1ed9c t\xednh body request v\xe0 response \u1edf c\xe1c file m\xe0 ta \u0111\u1ecbnh ngh\u0129a DTO."}),"\n",(0,t.jsxs)(e.li,{children:["Thi\u1ebft l\u1eadp thu\u1ed9c t\xednh ",(0,t.jsx)(e.code,{children:"required"}),' t\xf9y thu\u1ed9c v\xe0o d\u1ea5u "?" \u1edf property (v\xed d\u1ee5: ',(0,t.jsx)(e.code,{children:"name?: string"})," s\u1ebd \u0111\u1eb7t ",(0,t.jsx)(e.code,{children:"required: false"}),")"]}),"\n",(0,t.jsxs)(e.li,{children:["Thi\u1ebft l\u1eadp ",(0,t.jsx)(e.code,{children:"type "}),"ho\u1eb7c ",(0,t.jsx)(e.code,{children:"enum "}),"t\xf9y thu\u1ed9c v\xe0o ki\u1ec3u ta \u0111\u1ecbnh ngh\u0129a (h\u1ed7 tr\u1ee3 ki\u1ec3u m\u1ea3ng)"]}),"\n",(0,t.jsxs)(e.li,{children:["Thi\u1ebft l\u1eadp gi\xe1 tr\u1ecb ",(0,t.jsx)(e.code,{children:"default"})," d\u1ef1a tr\xean gi\xe1 tr\u1ecb m\u1eb7c \u0111\u1ecbnh \u0111\u01b0\u1ee3c g\xe1n"]}),"\n",(0,t.jsx)(e.li,{children:"Thi\u1ebft l\u1eadp m\u1ed9t s\u1ed1 quy t\u1eafc x\xe1c th\u1ef1c d\u1ef1a tr\xean c\xe1c tr\xecnh trang tr\xed class-validator"}),"\n"]})]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\u0110\u1ec3 thi\u1ebft l\u1eadp Swagger Plugin, v\xe0o file ",(0,t.jsx)(e.strong,{children:"nest-cli.json"})," v\xe0 th\xeam plugin nh\u01b0 sau:"]}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-json",children:'{\n  "collection": "@nestjs/schematics",\n  "sourceRoot": "src",\n  "compilerOptions": {\n    "plugins": ["@nestjs/swagger"]\n  }\n}\n'})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Ta c\xf3 th\u1ec3 th\xeam c\xe1c c\u1ea5u h\xecnh cho plugin:"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-json",children:'"plugins": [\n  {\n    "name": "@nestjs/swagger",\n    "options": {\n      "classValidatorShim": false,\n      "introspectComments": true\n    }\n  }\n]\n'})}),"\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"T\xf9y ch\u1ecdn"}),(0,t.jsx)(e.th,{children:"Gi\xe1 tr\u1ecb m\u1eb7c \u0111\u1ecbnh"}),(0,t.jsx)(e.th,{children:"M\xf4 t\u1ea3"})]})}),(0,t.jsx)(e.tbody,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"dtoFileNameSuffix"}),(0,t.jsx)(e.td,{children:(0,t.jsx)(e.code,{children:"['.dto.ts', '.entity.ts']"})}),(0,t.jsx)(e.td,{children:"\u0110u\xf4i file m\xe0 plugin s\u1ebd \u0111\u1ecdc DTO"})]})})]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"D\u01b0\u1edbi \u0111\xe2y l\xe0 so s\xe1nh khi ta kh\xf4ng d\xf9ng v\xe0 d\xf9ng Swagger Plugin:"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"export class CreateUserDto {\n  @ApiProperty()\n  email: string;\n\n  @ApiProperty()\n  password: string;\n\n  @ApiProperty({ enum: RoleEnum, default: [], isArray: true })\n  roles: RoleEnum[] = [];\n\n  @ApiProperty({ required: false, default: true })\n  isEnabled?: boolean = true;\n}\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"export class CreateUserDto {\n  email: string;\n  password: string;\n  roles: RoleEnum[] = [];\n  isEnabled?: boolean = true;\n}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"c\u1ea5u-h\xecnh-swagger",children:"C\u1ea5u h\xecnh Swagger"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["T\u1ea1o file ",(0,t.jsx)(e.strong,{children:"swagger.config.ts"}),":"]}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:'import { DocumentBuilder, SwaggerCustomOptions } from "@nestjs/swagger";\n\nexport const swaggerConfig = new DocumentBuilder()\n  .setTitle("Task Management APIs")\n  .setDescription("The Task Management API description")\n  .setVersion("1.0")\n  .addBearerAuth({\n    type: "http",\n    scheme: "Bearer",\n    description: "Enter your access token here",\n  })\n  .build();\n\nexport const swaggerOptions: SwaggerCustomOptions = {\n  customSiteTitle: "Task Management API",\n  customCss: ".swagger-ui section.models { display: none}",\n  customfavIcon: "/public/static/app-logo.svg",\n};\n'})}),"\n",(0,t.jsx)(e.admonition,{type:"note",children:(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["Xem c\xe1ch c\u1ea5u h\xecnh \u0111\u1ec3 serve file t\u0129nh favIcon ",(0,t.jsx)(e.a,{href:"./serve-static-file",children:"t\u1ea1i \u0111\xe2y"})]}),"\n"]})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["Cu\u1ed1i c\xf9ng, \u1edf file ",(0,t.jsx)(e.strong,{children:"main.ts"}),":"]}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:'import { Logger } from "@nestjs/common";\nimport { ConfigService } from "@nestjs/config";\nimport { NestFactory } from "@nestjs/core";\nimport { SwaggerModule } from "@nestjs/swagger";\nimport { WinstonModule } from "nest-winston";\n\nimport { AppModule } from "./app.module";\nimport { winstonLogger } from "src/common/logger/logger.config";\nimport {\n  swaggerConfig,\n  swaggerOptions,\n} from "src/common/swagger/swagger.config";\nimport { IEnvironmentVariables } from "src/common/types/env.type";\n\nasync function bootstrap() {\n  const app = await NestFactory.create(AppModule, {\n    logger: WinstonModule.createLogger({ instance: winstonLogger }),\n  });\n  const configService = app.get(ConfigService<IEnvironmentVariables>);\n  const nestServerPort = configService.get<number>("NEST_SERVER_PORT")!;\n\n  app.setGlobalPrefix("api/v1");\n  app.enableCors({ origin: "*" });\n\n  const document = SwaggerModule.createDocument(app, swaggerConfig);\n  SwaggerModule.setup("/", app, document, swaggerOptions);\n\n  await app.listen(nestServerPort);\n  Logger.log(\n    `Server is running on: http://localhost:${nestServerPort}`,\n    bootstrap.name\n  );\n}\nbootstrap();\n'})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["V\xe0 gi\u1edd m\u1edf URL: ",(0,t.jsx)(e.strong,{children:(0,t.jsx)(e.a,{href:"http://localhost:8080/",children:"http://localhost:8080/"})})," v\xe0 Swagger API Document \u0111\xe3 \u0111\u01b0\u1ee3c thi\u1ebft l\u1eadp."]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"s\u1eed-d\u1ee5ng-nestjs-swagger-decorator-b\xean-trong-controller",children:"S\u1eed d\u1ee5ng NestJS Swagger decorator b\xean trong controller"}),"\n",(0,t.jsx)(e.admonition,{type:"info",children:(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["C\xe1c decorator c\u1ee7a NestJS Swagger th\u01b0\u1eddng hay \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng:","\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:"@ApiTags(name: string)"}),": \u0110\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 g\u1eafn th\u1ebb (tag) c\xe1c endpoints c\u1ee7a API nh\u1eb1m m\u1ee5c \u0111\xedch t\u1ed5 ch\u1ee9c v\xe0 ph\xe2n lo\u1ea1i ch\xfang trong t\xe0i li\u1ec7u Swagger."]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:"@ApiResponse({ type: ExceptionResponse, status: '4XX', description: 'Error' })"}),": Ch\u1ec9 \u0111\u1ecbnh l\u1ed7i tr\u1ea3 v\u1ec1 cho client v\u1edbi status trong kho\u1ea3ng t\u1eeb 400 \u0111\u1ebfn 499, chi ti\u1ebft c\xe1c thu\u1ed9c t\xednh l\u1ed7i \u0111\u01b0\u1ee3c m\xf4 t\u1ea3 th\xf4ng qua class ",(0,t.jsx)(e.code,{children:"ExceptionResponse"}),"."]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:"@ApiBearerAuth()"}),": \u0110\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 ch\u1ec9 \u0111\u1ecbnh r\u1eb1ng m\u1ed9t endpoint y\xeau c\u1ea7u x\xe1c th\u1ef1c b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng Bearer Token. Khi \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng, n\xf3 s\u1ebd th\xeam th\xf4ng tin v\u1ec1 Bearer Auth v\xe0o t\xe0i li\u1ec7u Swagger, gi\xfap ng\u01b0\u1eddi d\xf9ng API bi\u1ebft r\u1eb1ng h\u1ecd c\u1ea7n cung c\u1ea5p m\u1ed9t Bearer Token \u0111\u1ec3 truy c\u1eadp v\xe0o endpoint \u0111\xf3."]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:"@ApiConsumes('multipart/form-data')"}),": Ch\u1ec9 \u0111\u1ecbnh r\u1eb1ng m\u1ed9t endpoint ch\u1ea5p nh\u1eadn c\xe1c d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c g\u1eedi v\u1edbi lo\u1ea1i MIME multipart/form-data. \u0110\xe2y th\u01b0\u1eddng l\xe0 lo\u1ea1i MIME \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng khi g\u1eedi c\xe1c t\u1ec7p (file)."]}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:'import {\n  Body,\n  Controller,\n  Get,\n  HttpCode,\n  HttpStatus,\n  Param,\n  Post,\n  UseGuards\n} from \'@nestjs/common\';\nimport { ApiBearerAuth, ApiResponse, ApiTags } from \'@nestjs/swagger\';\n\n@ApiTags("Room")\n@ApiResponse({ type: ExceptionResponse, status: \'4XX\', description: \'Error\' })\n@ApiBearerAuth()\n@Controller("room")\n@UseGuards(RoomGuard)\nexport class RoomController {\n  constructor(private roomService: RoomService) {}\n\n  @Post("create")\n  async createRoom(\n    @Body() body: CreateRoomBodyDTO,\n    @UserId() userId: string\n  ): Promise<CreateRoomResponseDTO> {\n    const response = await this.roomService.createRoom(body, userId);\n    return plainToInstance(CreateRoomResponseDTO, response);\n  }\n\n  @Post("join/:roomId")\n  @HttpCode(HttpStatus.OK)\n  async joinRoom(\n    @Param("roomId") roomId: string,\n    @UserId() userId: string\n  ): Promise<JoinRoomResponseDTO> {\n    const response = await this.roomService.joinRoom(roomId, userId);\n    return plainToInstance(JoinRoomResponseDTO, response);\n  }\n\n  @Get("joined")\n  async getJoinedRooms(\n    @UserId() userId: string\n  ): Promise<GetAllJoinedRoomResponseDTO> {\n    const response = await this.roomService.getJoinedRooms(userId);\n    return plainToInstance(GetAllJoinedRoomResponseDTO, response);\n  }\n\n  @Get(":roomId/members")\n  @CheckPermission(GetRoomMemberPermissionHandler)\n  async getRoomMembers(\n    @Param("roomId") roomId: string\n  ): Promise<GetRoomMembersResponseDTO> {\n    const response = await this.roomService.getRoomMembers(roomId);\n    return plainToInstance(GetRoomMembersResponseDTO, response);\n  }\n}\n'})}),"\n",(0,t.jsx)(e.admonition,{type:"caution",children:(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"H\xe3y lu\xf4n ch\u1ec9 \u0111\u1ecbnh ki\u1ec3u tr\u1ea3 v\u1ec1 cho h\xe0m controller \u0111\u1ec3 NestJS Swagger Plugin c\xf3 th\u1ec3 t\u1ef1 \u0111\u1ed9ng t\u1ea1o ra docs \u0111\u1ecbnh ngh\u0129a c\xe1c thu\u1ed9c t\xednh cho response tr\u1ea3 v\u1ec1."}),"\n"]})}),"\n",(0,t.jsx)(e.h2,{id:"s\u1eed-d\u1ee5ng-nestjs-swagger-decorator-\u0111\u1ec3-\u0111\u1ecbnh-ngh\u0129a-dto",children:"S\u1eed d\u1ee5ng NestJS Swagger decorator \u0111\u1ec3 \u0111\u1ecbnh ngh\u0129a DTO"}),"\n",(0,t.jsxs)(e.admonition,{type:"note",children:[(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"M\u1eb7c d\xf9 NestJS Swagger t\u1ef1 \u0111\u1ed9ng \u0111\u1ecbnh ngh\u0129a docs cho c\xe1c thu\u1ed9c t\xednh c\u1ee7a object body, query \u1edf c\xe1c file DTO th\xf4ng qua plugin, nh\u01b0ng \u0111\xf4i khi ta v\u1eabn c\u1ea7n \u0111\u1ecbnh ngh\u0129a th\xeam nh\u01b0 description, ho\u1eb7c \u0111\u1ecbnh ngh\u0129a 1 tr\u01b0\u1eddng cho upload file. \u0110\u1ec3 l\xe0m \u0111i\u1ec1u \u0111\xf3, ta s\u1eed d\u1ee5ng decorator:"}),"\n"]}),(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"@ApiProperty(options?: ApiPropertyOptions)\n"})})]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"M\u1ed9t s\u1ed1 v\xed d\u1ee5:"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"// \u0110\u1ecbnh ngh\u0129a description cho thu\u1ed9c t\xednh\n@ApiProperty({ description: 'Your password' })\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:'/* \n- \u0110\u1ecbnh ngh\u0129a format cho gi\xe1 tr\u1ecb c\u1ee7a thu\u1ed9c t\xednh, cho ph\xe9p ta ch\u1ec9 \u0111\u1ecbnh \u0111\u1ecbnh d\u1ea1ng c\u1ee7a d\u1eef li\u1ec7u cho thu\u1ed9c t\xednh \u0111\xf3, gi\xfap Swagger hi\u1ec3u r\xf5 h\u01a1n v\u1ec1 ki\u1ec3u d\u1eef li\u1ec7u v\xe0 c\xe1ch hi\u1ec3n th\u1ecb n\xf3 trong t\xe0i li\u1ec7u.\n- C\xe1c gi\xe1 tr\u1ecb c\xf3 th\u1ec3 nh\u1eadn c\u1ee7a format: "date", "date-time", "binary", "email", "uuid", "hostname", "ipv4", "ipv6"\n*/\n@ApiProperty({ format: \'ipv4\' })\n\n// \u0110\u1ecbnh ngh\u0129a m\u1ed9t thu\u1ed9c t\xednh nh\u1eadn 1 File\n@ApiProperty({ type: \'string\', format: \'binary\' })\n\n// \u0110\u1ecbnh ngh\u0129a m\u1ed9t thu\u1ed9c t\xednh nh\u1eadn nhi\u1ec1u File\n@ApiProperty({ type: \'string\', format: \'binary\', isArray: true })\n'})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"// Thi\u1ebft l\u1eadp v\xed d\u1ee5 c\u1ee7a gi\xe1 tr\u1ecb c\u1ee7a thu\u1ed9c t\xednh\n@ApiProperty({ example: 'abc@gmail.com' })\n@ApiProperty({ default: 'abc@gmail.com' })\n"})})]})}function d(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(h,{...n})}):h(n)}},8453:(n,e,s)=>{s.d(e,{R:()=>i,x:()=>c});var t=s(6540);const r={},o=t.createContext(r);function i(n){const e=t.useContext(o);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:i(n.components),t.createElement(o.Provider,{value:e},n.children)}}}]);